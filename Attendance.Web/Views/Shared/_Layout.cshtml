<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - سامانه مدیریت دانش آموزان</title>
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/output.css" asp-append-version="true" />
</head>
<body class ="bg-svg-grid bg-slate-50 min-h-screen text-gray-800 min-h-screen flex flex-col">
    <!-- نوار بالا -->
    <header class="w-full h-16 bg-white border-b px-6 flex items-center justify-between">
        <!-- فقط موبایل -->
        <div class="md:hidden flex items-center gap-2">
            <button onclick="toggleMobileMenu()" class="bg-white p-2">
                <svg class="w-6 h-6 text-gray-700" fill="none" stroke="currentColor" stroke-width="2"
                     viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M4 6h16M4 12h16M4 18h16"></path>
                </svg>
            </button>
        </div>
        <nav class="hidden md:flex items-center gap-6 text-sm font-medium">
            <a asp-controller="Home" asp-action="Index" class="text-slate-800">خانه</a>
            <a href="#" class="text-gray-500 hover:text-slate-800">گزارشات</a>
            <a href="#" class="text-gray-500 hover:text-slate-800">آرشیو اطلاعات</a>
        </nav>
        <div class="text-sm text-gray-500">
            کاربر جاری: <span class="font-semibold text-gray-800">سید محمد جعفری</span>
        </div>
    </header>

    <div class="flex flex-1 overflow-hidden">
        <!-- سایدبار اصلی (فقط در md و بالاتر) -->
        <aside class="hidden md:block w-64 bg-white border-l flex-shrink-0 overflow-y-auto">
            <div class="p-4 border-b">
                <div class="text-sm text-center font-bold text-slate-800">سیستم مدیریت دانش آموزان</div>
            </div>
            <nav class="p-4 space-y-1 text-sm">
                <a asp-controller="Home" asp-action="Index" class="flex items-center justify-between px-3 py-2 rounded-md bg-blue-500 text-slate-100">
                    <span>پیشخوان</span>
                </a>

                <a asp-controller="Students" asp-action="Index" class="block px-3 py-2 rounded-md text-slate-600 hover:bg-blue-100/70">
                    <span>لیست دانش آموزان</span>
                </a>

                <a asp-controller="Attendance" asp-action="CreateWizard" class="block px-3 py-2 rounded-md text-slate-600 hover:bg-blue-100/70">
                    <span> حضور و غیاب</span>
                </a>

                <a asp-controller="#" asp-action="Index" class="block px-3 py-2 opacity-50 cursor-not-allowed rounded-md text-slate-600 hover:bg-blue-100/70">
                    <span>لیست مربیان</span>
                    <span class="dev-badge soft-pulse ml-2 inline-flex items-center gap-1 text-xs font-semibold rounded px-2 py-0.5 select-none" aria-hidden="true">در حال توسعه</span>
                </a>

                <a asp-controller="Attendance" asp-action="AllSessions" class="block px-3 py-2 rounded-md text-slate-600 hover:bg-blue-100/70">
                    <span>لیست  جلسات</span>
                </a>

                <a asp-controller="#" asp-action="Index" class="block px-3 py-2 opacity-50 cursor-not-allowed rounded-md text-slate-600 hover:bg-blue-100/70">
                    <span>گزارشات</span>
                    <span class="dev-badge soft-pulse ml-2 inline-flex items-center gap-1 text-xs font-semibold rounded px-2 py-0.5 select-none" aria-hidden="true">در حال توسعه</span>
                </a>

                <a asp-controller="Attendance" asp-action="ArchivedSessions" class="block px-3 py-2 rounded-md text-slate-600 hover:bg-blue-100/70">
                    <span>آرشیو و بایگانی</span>
                </a>

                <a asp-controller="#" asp-action="Index" class="block px-3 py-2 opacity-50 cursor-not-allowed rounded-md text-slate-600 hover:bg-blue-100/70">
                    <span>صورتجلسه ها</span>
                    <span class="dev-badge soft-pulse ml-2 inline-flex items-center gap-1 text-xs font-semibold rounded px-2 py-0.5 select-none" aria-hidden="true">در حال توسعه</span>
                </a>

                <a asp-controller="#" asp-action="Index" class="block px-3 py-2 opacity-50 cursor-not-allowed rounded-md text-slate-600 hover:bg-blue-100/70">
                    <span>پیامک</span>
                    <span class="dev-badge soft-pulse ml-2 inline-flex items-center gap-1 text-xs font-semibold rounded px-2 py-0.5 select-none" aria-hidden="true">در حال توسعه</span>
                </a>

                <a asp-controller="#" asp-action="Index" class="block px-3 py-2 opacity-50 cursor-not-allowed rounded-md text-slate-600 hover:bg-blue-100/70">
                    <span> کاربران</span>
                    <span class="dev-badge soft-pulse ml-2 inline-flex items-center gap-1 text-xs font-semibold rounded px-2 py-0.5 select-none" aria-hidden="true">در حال توسعه</span>
                </a>

                <a asp-controller="#" asp-action="Index" class="block px-3 py-2 opacity-50 cursor-not-allowed rounded-md text-slate-600 hover:bg-blue-100/70">
                    <span>تنظیمات سیستم</span>
                    <span class="dev-badge soft-pulse ml-2 inline-flex items-center gap-1 text-xs font-semibold rounded px-2 py-0.5 select-none" aria-hidden="true">در حال توسعه</span>
                </a>

                <a asp-controller="#" asp-action="Index" class="block px-3 py-2 opacity-50 cursor-not-allowed rounded-md text-slate-600 hover:bg-blue-100/70">
                    <span>خروج </span>
                    <span class="dev-badge soft-pulse ml-2 inline-flex items-center gap-1 text-xs font-semibold rounded px-2 py-0.5 select-none" aria-hidden="true">در حال توسعه</span>
                </a>
            </nav>
        </aside>

        <!-- سایدبار موبایل (فقط منو) -->
        <aside id="mobileSidebar"
               class="fixed top-0 right-0 h-full w-64 bg-white border-l shadow-lg z-40 transform translate-x-full transition-transform duration-300 md:hidden">
            <div class="p-4 border-b flex items-center justify-between">
                <div class="text-sm font-semibold text-slate-800">سیستم مدیریت دانش آموزان</div>
                <button onclick="toggleMobileMenu()" class="text-gray-500 hover:text-red-500">
                    ✕
                </button>
            </div>
            <nav class="p-4 space-y-1 text-sm">
                <a asp-controller="Home" asp-action="Index" class="flex items-center justify-between px-3 py-2 rounded-md bg-blue-500 text-slate-100">
                    <span>پیشخوان</span>
                </a>

                <a asp-controller="Students" asp-action="Index" class="block px-3 py-2 rounded-md text-slate-600 hover:bg-blue-100/70">
                    <span>لیست دانش آموزان</span>
                </a>

                <a asp-controller="Attendance" asp-action="CreateWizard" class="block px-3 py-2 rounded-md text-slate-600 hover:bg-blue-100/70">
                    <span> حضور و غیاب</span>
                </a>

                <a asp-controller="#" asp-action="Index" class="block px-3 py-2 opacity-50 cursor-not-allowed rounded-md text-slate-600 hover:bg-blue-100/70">
                    <span>لیست مربیان</span>
                    <span class="dev-badge soft-pulse ml-2 inline-flex items-center gap-1 text-xs font-semibold rounded px-2 py-0.5 select-none" aria-hidden="true">در حال توسعه</span>
                </a>

                <a asp-controller="Attendance" asp-action="AllSessions" class="block px-3 py-2 rounded-md text-slate-600 hover:bg-blue-100/70">
                    <span>لیست  جلسات</span>
                </a>

                <a asp-controller="#" asp-action="Index" class="block px-3 py-2 opacity-50 cursor-not-allowed rounded-md text-slate-600 hover:bg-blue-100/70">
                    <span>گزارشات</span>
                    <span class="dev-badge soft-pulse ml-2 inline-flex items-center gap-1 text-xs font-semibold rounded px-2 py-0.5 select-none" aria-hidden="true">در حال توسعه</span>
                </a>

                <a asp-controller="Attendance" asp-action="ArchivedSessions" class="block px-3 py-2 rounded-md text-slate-600 hover:bg-blue-100/70">
                    <span>آرشیو و بایگانی</span>
                </a>

                <a asp-controller="#" asp-action="Index" class="block px-3 py-2 opacity-50 cursor-not-allowed rounded-md text-slate-600 hover:bg-blue-100/70">
                    <span>صورتجلسه ها</span>
                    <span class="dev-badge soft-pulse ml-2 inline-flex items-center gap-1 text-xs font-semibold rounded px-2 py-0.5 select-none" aria-hidden="true">در حال توسعه</span>
                </a>

                <a asp-controller="#" asp-action="Index" class="block px-3 py-2 opacity-50 cursor-not-allowed rounded-md text-slate-600 hover:bg-blue-100/70">
                    <span>پیامک</span>
                    <span class="dev-badge soft-pulse ml-2 inline-flex items-center gap-1 text-xs font-semibold rounded px-2 py-0.5 select-none" aria-hidden="true">در حال توسعه</span>
                </a>

                <a asp-controller="#" asp-action="Index" class="block px-3 py-2 opacity-50 cursor-not-allowed rounded-md text-slate-600 hover:bg-blue-100/70">
                    <span> کاربران</span>
                    <span class="dev-badge soft-pulse ml-2 inline-flex items-center gap-1 text-xs font-semibold rounded px-2 py-0.5 select-none" aria-hidden="true">در حال توسعه</span>
                </a>

                <a asp-controller="#" asp-action="Index" class="block px-3 py-2 opacity-50 cursor-not-allowed rounded-md text-slate-600 hover:bg-blue-100/70">
                    <span>تنظیمات سیستم</span>
                    <span class="dev-badge soft-pulse ml-2 inline-flex items-center gap-1 text-xs font-semibold rounded px-2 py-0.5 select-none" aria-hidden="true">در حال توسعه</span>
                </a>

                <a asp-controller="#" asp-action="Index" class="block px-3 py-2 opacity-50 cursor-not-allowed rounded-md text-slate-600 hover:bg-blue-100/70">
                    <span>خروج </span>
                    <span class="dev-badge soft-pulse ml-2 inline-flex items-center gap-1 text-xs font-semibold rounded px-2 py-0.5 select-none" aria-hidden="true">در حال توسعه</span>
                </a>
            </nav>
        </aside>

        <!-- محتوای مرکزی -->
        <main class="flex-1 overflow-y-auto p-6">
            @RenderBody()
            <!-- استفاده از انیمیشن به صورت سراسری در پروژه -->
            <div id="global-loader"
                 class="fixed inset-0 z-50 flex items-center justify-center bg-white/40 backdrop-blur-sm hidden animate-fade-scale">
                <div class="p-4 rounded-lg bg-white shadow-xl flex items-center gap-3">
                    <svg class="w-6 h-6 animate-spin text-blue-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8z"></path>
                    </svg>

                    <div>
                        <div class="text-sm font-medium text-slate-700">در حال بارگذاری...</div>
                        <div class="text-xs text-slate-500">لطفاً منتظر بمانید</div>
                    </div>
                </div>
            </div>
            <script>
                document.addEventListener('DOMContentLoaded', function () {

                    const loader = document.getElementById('students-loader');
                    if (!loader) return;

                    // فقط لینک‌های واقعی داخلی
                    document.querySelectorAll('a[href]').forEach(link => {

                        link.addEventListener('click', function (e) {

                            // اگر لینک غیرفعال است
                            if (this.classList.contains('cursor-not-allowed')) return;

                            // اگر target=_blank دارد
                            if (this.target === '_blank') return;

                            // اگر href خالی یا #
                            const href = this.getAttribute('href');
                            if (!href || href === '#') return;

                            // اگر لینک خارجی است
                            if (href.startsWith('http') && !href.startsWith(window.location.origin)) return;

                            // ✅ فقط Loader را نشان بده
                            loader.classList.remove('hidden');

                            // ⛔ هیچ preventDefault
                            // ⛔ هیچ fetch
                        });
                    });

                });
            </script>
        </main>
    </div>

    <footer class="bg-white border-t text-center py-4 text-xs text-slate-400">
        1404-2025 | کلیه حقوق سامانه محفوظ است. &copy;
    </footer>

    <script>
        function toggleMobileMenu() {
            const sidebar = document.getElementById("mobileSidebar");
            sidebar.classList.toggle("translate-x-full");
        }
    </script>
    @await RenderSectionAsync("IndexStudentsScripts", required: false)
    @await RenderSectionAsync("CreateStudentsScripts", required: false)
    @await RenderSectionAsync("EditStudentsScripts", required: false)
    @await RenderSectionAsync("DeleteSoftStudentsScripts", required: false)
    @await RenderSectionAsync("ArchiveStudentsScripts", required: false)
    @await RenderSectionAsync("ArchivedSessionsScripts", required: false)
    @await RenderSectionAsync("AllSessionsStudentsScripts", required: false)
    @await RenderSectionAsync("DetailsStudentsScripts", required: false)
    @await RenderSectionAsync("CreateWizardSesstionScripts", required: false)
    @await RenderSectionAsync("SessionDetailsScripts", required: false)
    <script src="~/js/js_Animated/loader.js"></script>
    <script>
        // lightweight, jittered pulse using requestAnimationFrame (optional)
        (function(){
          const badges = Array.from(document.querySelectorAll('.dev-badge.soft-pulse'));
          if (!badges.length) return;
          // each badge gets its own phase offset
          const offsets = badges.map((_,i) => i * 0.18 + Math.random()*0.06);
          const period = 1200; // ms match CSS duration
          function rafLoop(t){
            badges.forEach((b, i) => {
              const phase = ((t/period) + offsets[i]) % 1; // 0..1
              // calculate eased opacity/scale similar to CSS keyframe
              // we use simple easing function here:
              let v = Math.sin(phase * Math.PI * 2) * 0.5 + 0.5; // 0..1 sinusoidal
              // map to opacity between 0.45 and 1
              const opacity = 0.45 + 0.55 * v;
              const scale = 0.98 + 0.02 * v;
              b.style.opacity = String(opacity);
              b.style.transform = `translateZ(0) scale(${scale})`;
            });
            requestAnimationFrame(rafLoop);
          }
          requestAnimationFrame(rafLoop);
        })();
    </script>
</body>
</html>
